# Harjoitus 3: Tee WebGoat harjoituksia

Harjoitustehtävä Tero Karvisen kurssille. Tehtävänä ratkoa WebGoatin tehtäviä.
- http://terokarvinen.com/2019/penetration-testing-tunkeutumistestaus-ict4tn027-3004-intensive-summer-course-2019-w21w22-5-credits

Valitsin joitain tehtäviä, joista raportoin.

## LAB: Role Based Access Control. Stage 1

Tavoitteena saada poistettua profiili, vaikka siihen ei ole oikeuksia. Eli kiertää access control. Poisto piti tehdä tavallisena käyttäjänä (Tom).

Käytin tässä FireFoxin developer toolia, toinen vaihtoehto olisi ollut käyttää MITMPROXY:a

Ensin tutkin miten toimii profiilin poisto toimii admin-oikeusilla.
```
<input name="action" value="DeleteProfile" type="submit">
```

Toiminnon arvona oli "DeleteProfile". Muutin tämän arvon kirjautuneena Tomina sisään.
```
<input name="action" value="ViewProfile" type="submit">
```
Value: View Profile --> DeleteProfile

![](https://raw.githubusercontent.com/immonju1/pentest/master/reports/pics/delete.png)

## LAB: Role Based Access Control. Stage 3.

Tehtävässä tavoitteena nähdä toisen työntekijän profiili, ohittamalla pääsynhallinta.

Tein tehtävän mitproxy:llä, profiili, jota katsotaan sen id on muutetttavissa. Ohjelma ei tarkista kenen profiilia katsotaan.

Muutin parametria empluee_id arvoon 110, jolloin näin Joanne NcDougalin tiedot.

![](https://raw.githubusercontent.com/immonju1/pentest/master/reports/pics/profile.png)

## XML Injection

Tehtävässä piti hyödyntää XML injektiota. Tein tehtävän hyödyntämällä http-proxyn interception ominaisuutta mitmproxy:ssa.

Tehtävä oli hankala kun interception toiminnallisuus ei ollut tuttu. Ideana on pysäyttää respone ja lisätä sinne XML injketio.

mitmproxy:ssa interception tilan saa käytöön
- i-kirjain komennolla
- pattern oli attack
- a-kirjain komennolla response / request palautuu web-sivulle

Lisäsin responseen rivin

```
<root>
<reward>WebGoat Hawaii Cruise 3000 Pts</reward>
</root>
```

jolloin tulostui alla oleva, laittamalla kaikki

![](https://raw.githubusercontent.com/immonju1/pentest/master/reports/pics/vaikutus.png)


## Command Injection

Muutin kutsun parametreja FFn developer toolilla (F12), siten että ajettiin haluami OS komento.

Muutettu rivi:

```
<option>"; ls"</option>
```

Tulos

```
ExecResults for '[/bin/sh, -c, cat "/home/goat/.extract/webapps/WebGoat/plugin_extracted/plu
Output...
UserDatabase.mv.db
webgoat-container-7.0.1-war-exec.jar
Returncode: 0
```

## Log Spoofing

Tehtävässä piti keksiä mikä on rivinvaihdon UTF-8 heksakoodi. Tämä oli vaikea keksiä ja vaati paljon googlaamista.

Eli syöttämällä oikea UTF-koodi tekstinä, lokiin tulostuu toinen rivi, jonka mukaan login onnistui. Tällöin voi kirjoittaa lokiin omaa tekstiä, mahdollisesti omaa koodia.

![](https://raw.githubusercontent.com/immonju1/pentest/master/reports/pics/loki.png)



